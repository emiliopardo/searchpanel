!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports='<div id="div-contenedor" class="m-control m-container m-searchpanel">\n  <div class="m-searchpanel-plugin">\n    \x3c!-- TITLE --\x3e\n    <div class="m-searchpanel-title">{{title}}</div>\n    \x3c!-- BODY--\x3e\n    <div class="m-searchpanel-body">\n      <div id="m-searchpanel-content">\n        {{#each fields}}\n        <div id="field_{{field}}" class="m-searchpanel-opciones-busqueda">\n          <label class="m-searchpanel-label-opciones-busqueda" for="textbox{{alias}}">{{alias}}</label>\n          <input id="{{field}}" name="textbox{{alias}}" type="text" maxlength="150" placeholder="{{alias}} ...">\n          <span class="m-searchpanel-info-opciones">* {{label}}</span>\n        </div>\n        {{/each}}\n      </div>\n      <div id="m-searchpanel-result-content" class="results">\n        <div id="results" class="results">\n          <table class="center">\n            <tbody>\n              <tr>\n                <th class="noResults" colspan="2">\n                  <p>No se ha encontrado ningún resultado</p>\n                </th>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n      <div id="m-searchpanel-result-pagination" class="page">\n        <div class="page">\n          <table style="width:100%">\n            <tbody>\n              <tr>\n                <td id="previusPage" class="g-cartografia-flecha-izquierda">Atrás</td>\n                <td id="recordsInfo"><span id="recordsNumber" class="found">0</span> de\n                  <span id="recordsTotal" class="total">0</span>\n                </td>\n                <td id="nextPage" class="g-cartografia-flecha-derecha">Siguiente</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n      <div class="m-searchpanel-buttons">\n        <button id="m-searchpanel-loadButton" class="load" disabled="disabled" title="Ejecutar">\n          <i class="g-cartografia-posicion3"></i> Ejecutar</button>\n        <button id="m-searchpanel-clearButton" class="clear" disabled="disabled" title="Limpiar">\n          <i class="g-cartografia-check4"></i> Limpiar</button>\n      </div>\n    </div>\n  </div>\n</div>'},function(e){e.exports=JSON.parse('{"url":{"name":"Searchpanel","separator":"*"},"constructor":"M.plugin.Searchpanel","parameters":[],"files":{"ol":{"scripts":[],"styles":[]}},"metadata":{"uuid_plugin":"","uuid_version_plugin":"","version_ficha_metadatos":"","name":"Searchpanel","description":"Description of the plugin","text":"A full text about plugin","version":"1.0.0","date":"","author":"","org":"","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg","buttons":[{"title":"","description":"","querySelector":""},{"title":"","description":"","querySelector":""}],"dependencies":{"modules":["",""],"plugins":[{"uuid":"","name":""}],"services":[{"name":"","description":""}]},"compatibility":["6.0.0"]}}')},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(2);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(p,M.impl.Control);var t,n,i,c=l(p);function p(){return o(this,p),c.apply(this,arguments)}return t=p,(n=[{key:"addTo",value:function(e,t){var n=this;e.getMapImpl().getInteractions().forEach((function(e){e instanceof ol.interaction.DoubleClickZoom&&(n.dblClickInteraction_=e)})),a(u(p.prototype),"addTo",this).call(this,e,t)}},{key:"activate",value:function(){}},{key:"deactivate",value:function(){}}])&&r(t.prototype,n),i&&r(t,i),p}(),d=n(0),f=n.n(d);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function m(e,t,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=P(e);if(t){var o=P(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return v(this,n)}}function v(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(r,M.Control);var t,n,i,o=g(r);function r(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),M.utils.isUndefined(p)&&M.exception("La implementación usada no puede crear controles SearchpanelControl");var n=new p;return(t=o.call(this,n,"Searchpanel")).config=e,t.maxResults=t.config.maxResults,t.title=t.config.title,t.fields=t.config.fields,t.infofields=t.config.infoFields,t.geosearchUrl=t.config.geosearchUrl+"q=",t.otherParameters="&rows="+t.maxResults+"&start=0&srs=EPSG%3A25830",t.maxRecordsPage=8,t.totalRecords=null,t.pageNumber=1,t.pageTotal=null,t.dataList=new Array,t.capaGeoJSON=null,t.wktFormatter=new ol.format.WKT,t.selectedFeatures=null,t.arrayFeaturesMapeaGeoJSON=null,t.stylePoint=new M.style.Point({radius:5,fill:{color:"#00796b",opacity:.7},stroke:{color:"#00796b"}}),t.stylePolygon=new M.style.Polygon({radius:5,fill:{color:"#00796b",opacity:.7},stroke:{color:"#00796b"}}),t.styleLine=new M.style.Line({radius:5,fill:{color:"#00796b",opacity:.7},stroke:{color:"#00796b"}}),t}return t=r,(n=[{key:"createView",value:function(e){var t=this,n={vars:{title:this.title,fields:this.fields}};return new Promise((function(e,i){var o=M.template.compileSync(f.a,n);t.element=o,t.addEvents(o,t.fields),e(o)}))}},{key:"activate",value:function(){m(P(r.prototype),"activate",this).call(this),this.getImpl().activate(this.map_)}},{key:"deactivate",value:function(){m(P(r.prototype),"deactivate",this).call(this),this.getImpl().deactivate(this.map_)}},{key:"getActivationButton",value:function(e){return e.querySelector(".m-searchpanel button")}},{key:"equals",value:function(e){return e instanceof r}},{key:"addEvents",value:function(e){var t=this;this.loadButton=e.querySelector("button#m-searchpanel-loadButton"),this.clearButton=e.querySelector("button#m-searchpanel-clearButton"),this.searchOptions=e.querySelectorAll("input[type=text]"),this.searchPanel=e.querySelector("div#m-searchpanel-content"),this.resultPanel=e.querySelector("div#m-searchpanel-result-content"),this.results=e.querySelector("div#results"),this.resultPagination=e.querySelector("div#m-searchpanel-result-pagination"),this.previusPage=e.querySelector("td#previusPage"),this.nextPage=e.querySelector("td#nextPage"),this.recordsTotal=e.querySelector("span#recordsTotal"),this.recordsNumber=e.querySelector("span#recordsNumber"),this.loadButton.addEventListener("click",(function(){return t.load()})),this.clearButton.addEventListener("click",(function(){return t.clear()})),this.previusPage.addEventListener("click",(function(){return t.showPreviusPage()})),this.nextPage.addEventListener("click",(function(){return t.showNextPage()}));for(var n=0;n<this.searchOptions.length;n++)this.searchOptions[n].addEventListener("change",(function(){return t.enableButtons(e)}));this.results.addEventListener("click",(function(e){t.map_.removeLayers(t.capaGeoJSON),t.selectedFeatures=new Array;var n=e.target.closest("table"),i=!1;do{for(var o=0;o<t.arrayFeaturesMapeaGeoJSON.length;o++)t.arrayFeaturesMapeaGeoJSON[o].id==n.id&&(t.selectedFeatures.push(t.arrayFeaturesMapeaGeoJSON[o]),i=!0)}while(!i);var r=t.setStyle(t.selectedFeatures[0].geometry.type);t.capaGeoJSON=new M.layer.GeoJSON({extract:!1,source:{crs:{properties:{name:"EPSG:25830"},type:"name"},features:t.selectedFeatures,type:"FeatureCollection"},name:"result"}),t.capaGeoJSON.setStyle(r),t.map_.addLayers(t.capaGeoJSON),t.capaGeoJSON.displayInLayerSwitcher=!1,t.capaGeoJSON.calculateMaxExtent().then((function(e){t.map_.setBbox(e)}))}))}},{key:"setStyle",value:function(e){var t=null;switch(e){case e="Point":case e="MultiPoint":t=this.stylePoint;break;case e="LineString":case e="MultiLineString":t=this.styleLine;break;case e="Polygon":case e="MultiPolygon":t=this.stylePolygon;break;default:t=null}return t}},{key:"load",value:function(){var e=this,t="",n=new Array;this.arrayFeaturesMapeaGeoJSON=new Array;for(var i=0;i<this.searchOptions.length;i++)n.push(this.searchOptions[i].id+':"'+this.searchOptions[i].value+'"');for(var o=0;o<n.length;o++)o==n.length-1?t+=n[o]:t+=n[o]+" and ";var r=this.map_.getProjection().code,a=this.wktFormatter;M.remote.get(this.geosearchUrl+encodeURI(t)+this.otherParameters).then((function(t){JSON.parse(t.text).response.docs.forEach((function(t){var n=a.readFeature(t.geom,{dataProjection:r});n.setId(t.solrid),n.setProperties(t);var i=M.impl.Feature.olFeature2Facade(n);e.arrayFeaturesMapeaGeoJSON.push(i.getGeoJSON())})),e.showResults(e.arrayFeaturesMapeaGeoJSON)}))}},{key:"clear",value:function(){this.pageNumber=1;for(var e=0;e<this.searchOptions.length;e++)this.searchOptions[e].value="";this.searchPanel.style.display="block",this.resultPanel.style.display="none",this.resultPagination.style.display="none",this.loadButton.disabled=!0,this.clearButton.disabled=!0}},{key:"enableButtons",value:function(){this.loadButton.disabled=!1,this.clearButton.disabled=!1}},{key:"paginate",value:function(e){return e.slice((this.pageNumber-1)*this.maxRecordsPage,this.pageNumber*this.maxRecordsPage)}},{key:"createResultContent",value:function(e){for(var t="",n=0;n<e.length;n++)t+=this.recordInfoTable(e[n]);return t}},{key:"recordInfoTable",value:function(e){for(var t='<table id="'+e.properties.solrid+'" class="record-result">\n<tbody class="pointer-none">\n<tr class="rowResult" >\n',n=0;n<this.infofields.length;n++)t+='<td class="key">'+this.infofields[n].alias+'</td>\n<td class="value">'+e.properties[this.infofields[n].field]+"</td>\n</tr>";return t+="\n</tbody>\n</table>\n"}},{key:"showResults",value:function(e){if(this.dataList=e,this.dataList.length>0){this.totalRecords=this.dataList.length,this.dataList.length%this.maxRecordsPage==0?this.pageTotal=this.dataList.length/this.maxRecordsPage:this.pageTotal=Math.floor(this.dataList.length/this.maxRecordsPage)+1;var t=this.paginate(this.dataList),n=this.createResultContent(t);this.createResultPagination(),this.results.innerHTML=n,this.loadButton.disabled=!0}else this.results.innerHTML='<table class="center">\n<tbody>\n<tr>\n<th class="noResults" colspan="2">\n<p>No se ha encontrado ningún resultado</p>\n</th>\n</tr>\n</tbody>\n</table>',this.recordsNumber.textContent="0",this.recordsTotal.textContent="0",this.previusPage.style.visibility="hidden",this.nextPage.style.visibility="hidden";this.resultPagination.style.display="block",this.resultPanel.style.display="block",this.searchPanel.style.display="none"}},{key:"createResultPagination",value:function(){this.recordsTotal.textContent=this.totalRecords,this.totalRecords<this.maxRecordsPage?(this.recordsNumber.textContent=this.totalRecords,this.previusPage.style.visibility="hidden",this.nextPage.style.visibility="hidden"):this.recordsNumber.textContent="1 - "+this.maxRecordsPage,1==this.pageNumber&this.totalRecords>this.maxRecordsPage?(this.previusPage.style.visibility="hidden",this.nextPage.style.visibility="visible"):1==this.pageNumber&this.totalRecords<=this.maxRecordsPage?(this.previusPage.style.visibility="hidden",this.nextPage.style.visibility="hidden"):(this.previusPage.style.visibility="visible",this.nextPage.style.visibility="visible")}},{key:"showPreviusPage",value:function(){this.pageNumber-=1;var e=this.paginate(this.dataList),t=this.createResultContent(e);this.results.innerHTML=t,1==this.pageNumber?(this.recordsNumber.textContent="1 - "+this.pageNumber*this.maxRecordsPage,this.previusPage.style.visibility="hidden",this.nextPage.style.visibility="visible"):(this.recordsNumber.textContent=this.pageNumber*this.maxRecordsPage-(this.maxRecordsPage-1)+" - "+this.pageNumber*this.maxRecordsPage,this.previusPage.style.visibility="visible",this.nextPage.style.visibility="visible")}},{key:"showNextPage",value:function(){this.pageNumber+=1;var e=this.paginate(this.dataList),t=this.createResultContent(e);this.results.innerHTML=t,this.pageNumber==this.pageTotal?(this.recordsNumber.textContent=this.totalRecords-e.length+" - "+this.totalRecords,this.previusPage.style.visibility="visible",this.nextPage.style.visibility="hidden"):(this.recordsNumber.textContent=this.pageNumber*this.maxRecordsPage-(this.maxRecordsPage-1)+" - "+this.pageNumber*this.maxRecordsPage,this.previusPage.style.visibility="visible",this.nextPage.style.visibility="visible")}}])&&y(t.prototype,n),i&&y(t,i),r}(),x=n(1);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=k(e);if(t){var o=k(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return N(this,n)}}function N(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(r,M.Plugin);var t,n,i,o=R(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this)).map_=null,t.panel_=null,t.config_=e.config,t.options_=e.options,t.position_=e.options.position||"TL","TL"===t.position_||"BL"===t.position_?t.positionClass_="left":t.positionClass_="right",t.controls_=[],t.metadata_=x.metadata,t}return t=r,(n=[{key:"addTo",value:function(e){var t=this;this.controls_.push(new w(this.config_)),this.map_=e,this.panel_=new M.ui.Panel("panelSearchpanel",{className:"search-panel ".concat(this.positionClass_),collapsible:!0,position:M.ui.position[this.position_],collapsedButtonClass:"g-cartografia-prismaticos",tooltip:this.config_.title}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_),this.panel_.on(M.evt.SHOW,(function(){"BR"==t.position_&&(document.getElementsByClassName("m-map-info").length>0&&(document.getElementsByClassName("m-map-info")[0].style.display="none"),document.getElementsByClassName("m-location").length>0&&(document.getElementsByClassName("m-location")[0].style.display="none"),document.getElementsByClassName("m-rotate").length>0&&(document.getElementsByClassName("m-rotate")[0].style.display="none")),"BL"==t.position_&&(document.getElementsByClassName("m-scaleline")[0].style.display="none")})),this.panel_.on(M.evt.HIDE,(function(){"BR"==t.position_&&(document.getElementsByClassName("m-map-info").length>0&&(document.getElementsByClassName("m-map-info")[0].style.display="block"),document.getElementsByClassName("m-location").length>0&&(document.getElementsByClassName("m-location")[0].style.display="block"),document.getElementsByClassName("m-rotate").length>0&&(document.getElementsByClassName("m-rotate")[0].style.display="block")),"BL"==t.position_&&(document.getElementsByClassName("m-scaleline")[0].style.display="block")}))}},{key:"position",get:function(){return this.position_}},{key:"getMetadata",value:function(){return this.metadata_}}])&&S(t.prototype,n),i&&S(t,i),r}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.Searchpanel=B,window.M.control.SearchpanelControl=w,window.M.impl.control.SearchpanelControl=p}]);
//# sourceMappingURL=searchpanel.ol.min.js.map